## Results Plotter

This repository now includes `scripts/plot_results.py`, a matplotlib-based helper that visualizes the JSON output generated by WebProber runs located under the `results/` directory.

### Getting Started

1. **Create (or reuse) a Python virtual environment** inside the project root:
   ```powershell
   python -m venv .venv
   ```
2. **Install matplotlib and its dependencies** into that environment:
   ```powershell
   .\.venv\Scripts\python -m pip install matplotlib
   ```

### Command Reference

The script supports three modes, all invoked via:
```powershell
.\.venv\Scripts\python scripts\plot_results.py [OPTIONS]
```

#### Summary Mode (default)

Compares aggregate statistics (mean/median/min/max/p95) across payload sizes for one or more result files.

Key options:
- `--json-files`: one or more result basenames or relative paths (defaults to every `results/*.json`).
- `--filesizes`: payload sizes to include. Omit to auto-detect all sizes present.
- `--aggregate`: statistic to compute per size (`mean`, `median`, `min`, `max`, `p95`; defaults to `mean`).
- `--title`: custom chart title.
- `--output`: path to save an image; omit to open an interactive window.
- `--show`: force opening an interactive window even when `--output` is set.
- `--smooth-window`: optional moving-average window applied to the plotted series (use values >1 to smooth curves).

Example:
```powershell
.\.venv\Scripts\python scripts\plot_results.py `
  --json-files 4000 4005 4010 `
  --filesizes 16K 64K 256K 1M 2M 4M `
  --aggregate median `
  --output summary_plot.png
```

#### Packets Mode

Plots per-packet timings for a single payload size, with each line representing a different port (result file).

Enable it with `--mode packets` and supply:
- `--filesize`: payload size (e.g. `1M`) to inspect.
- Other flags (`--json-files`, `--title`, `--output`, `--show`) behave as in summary mode.
You can also use `--smooth-window` here to smooth the per-packet curves.

Example:
```powershell
.\.venv\Scripts\python scripts\plot_results.py `
  --mode packets `
  --filesize 1M `
  --json-files 4000 4005 4010 `
  --output packets_plot.png
```

This produces a chart with packet sequence number on the x-axis and response time (seconds) on the y-axis, allowing you to compare jitter or spikes per port.

> Note: In packets mode the legend is drawn to the **right** of the plot so it does not overlap the graph itself.

#### Success Mode

Summarizes **success rate** and **average response time** per payload size, treating each selected JSON file independently.

For each filesize:

- **Success rate** is computed as the percentage of **non-null** measurements in the JSON.
- **Average response time** is computed from **only the non-null values** (null entries are ignored).
- The right-hand Y axis for response time is clamped to a fixed range of **0–3 seconds** for easier comparison across runs.

Key options:

- `--mode success`: enable success/latency plotting.
- `--json-files`: one or more result basenames or relative paths.
- `--filesizes`: payload sizes to include. Omit to auto-detect a shared set across all selected files.
- `--title`: custom chart title (used for all generated figures).
- `--output`: when set and multiple JSON files are provided, this is treated as a **base name**; one image per JSON file is created by suffixing the dataset label (e.g. `success.png` → `success-4000.png`, `success-4001.png`, …).
- `--show`: force opening interactive windows even when saving images.

Example:

```powershell
.\.venv\Scripts\python scripts\plot_results.py `
  --mode success `
  --json-files 4000 4005 4010 `
  --filesizes 16K 64K 256K 1M `
  --output success.png
```

This will write:

- `success-4000.png`
- `success-4005.png`
- `success-4010.png`

### Tips

- You can mix filename stems (`4000`) and explicit paths (`results/4000.json`) in `--json-files`.
- Pass both `--output` and `--show` if you want to save an image and launch a preview window concurrently.
